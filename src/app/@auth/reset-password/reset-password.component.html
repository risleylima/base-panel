<ng-container *ngIf="token && !token.isValid()">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h1 class="text-danger">
          <fa-icon [icon]="icons.faTimesCircle" size="3x" class="mb-3"></fa-icon>
          <br />
          Token Inválido!
        </h1>
      </div>
    </div>
  </div>
</ng-container>
<ng-container *ngIf="token && token.isValid()">
  <h1 id="title" class="title">Trocar Senha</h1>
  <p class="sub-title">Por favor defina uma nova senha.</p>
  <div class="row">
    <div class="col-12 text-center">
      <fa-icon [icon]="icons.faClock" size="3x"></fa-icon><br />
      <label *ngIf="token && token.isValid()">Expira em:
        {{ tokenExpiration.diff(agora,'seconds') * 1000 | date:'H:mm:ss':'UTC'}}
      </label>
    </div>
  </div>

  <form (ngSubmit)="resetPass()" #resetPassForm="ngForm" aria-labelledby="title">

    <div class="form-control-group">
      <label class="label" for="input-password">
        Nova senha:
        <span class="text-danger fw-bold">
          *
        </span>
        <ng-container *ngIf="password.invalid && password.touched ">
          <span class="text-danger ml-3" *ngIf="password.errors?.['required']">
            A senha é obrigatória!
          </span>
          <span class="text-danger ml-3" *ngIf="password.errors?.['minlength']">
            A senha deve conter
            no mínimo {{ getConfigValue('forms.validation.password.minLength') }}
            caracteres
          </span>
          <span class="text-danger ml-3" *ngIf="password.errors?.['maxlength']">
            A senha deve conter
            até {{ getConfigValue('forms.validation.password.maxLength') }}
            caracteres
          </span>
        </ng-container>
      </label>
      <input nbInput [(ngModel)]="user.password" #password="ngModel" type="password" id="input-password" name="password"
        class="first" placeholder="Digite sua senha" autofocus fullWidth
        [status]="password.dirty ? (password.invalid  ? 'danger' : 'success') : 'primary'"
        [required]="getConfigValue('forms.validation.password.required')"
        [minlength]="getConfigValue('forms.validation.password.minLength')"
        [maxlength]="getConfigValue('forms.validation.password.maxLength')"
        [attr.aria-invalid]="password.invalid && password.touched ? true : null">
    </div>

    <div class="form-group">
      <label class="label" for="input-re-password">
        Confirme a senha:
        <span class="text-danger fw-bold">
          *
        </span>
        <ng-container *ngIf="rePass.touched">
          <span class="text-danger ml-3" *ngIf="rePass.invalid && rePass.errors?.['required']">
            A confirmação da senha é obrigatória!
          </span>
          <span class="text-danger ml-3" *ngIf="password.value != rePass.value && !rePass.errors?.['required']">
            As senhas informadas não coincidem.
          </span>
          <span class="text-danger ml-3" *ngIf="password.errors?.['minlength']">
            A senha deve conter
            no mínimo {{ getConfigValue('forms.validation.password.minLength') }}
            caracteres
          </span>
          <span class="text-danger ml-3" *ngIf="password.errors?.['maxlength']">
            A senha deve conter
            até {{ getConfigValue('forms.validation.password.maxLength') }}
            caracteres
          </span>
        </ng-container>
      </label>
      <input nbInput [(ngModel)]="user.confirmPassword" #rePass="ngModel" id="input-re-password" name="rePass"
        type="password" class="last" placeholder="Digite novamente a mesma senha" fullWidth
        [status]="rePass.touched ? (rePass.invalid || password.value != rePass.value ? 'danger' : 'success') : 'primary'"
        [required]="getConfigValue('forms.validation.password.required')"
        [minlength]="getConfigValue('forms.validation.password.minLength')"
        [maxlength]="getConfigValue('forms.validation.password.maxLength')"
        [attr.aria-invalid]="rePass.invalid && rePass.touched ? true : null">
    </div>

    <button nbButton status="success" fullWidth
      [disabled]="submitted || !resetPassForm.valid || password.value != rePass.value" [class.btn-pulse]="submitted">
      Trocar Senha
    </button>
  </form>
</ng-container>

<section class="sign-in-or-up" aria-label="Sign in or sign up">
  <p><a class="text-link" routerLink="../login">Voltar ao Login</a></p>
</section>